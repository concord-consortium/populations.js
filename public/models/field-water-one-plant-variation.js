// Generated by CoffeeScript 1.7.1
(function() {
  var Agent, Environment, Events, Interactive, Rule, Species, ToolButton, Trait, env, helpers, plantSpecies;

  helpers = require('helpers');

  Environment = require('models/environment');

  Species = require('models/species');

  Agent = require('models/agent');

  Rule = require('models/rule');

  Trait = require('models/trait');

  Interactive = require('interactive/interactive');

  Events = require('events');

  ToolButton = require('interactive/tool-button');

  plantSpecies = require('species/varied-plants');

  env = require('environments/water-field');

  window.model = {
    run: function() {
      var moneyLeft, startingMoney, updateMoney;
      plantSpecies.defs.CHANCE_OF_MUTATION = 0.3;
      plantSpecies.setMutatable('size', false);
      this.interactive = new Interactive({
        environment: env,
        speedSlider: true,
        addOrganismButtons: [
          {
            species: plantSpecies,
            imagePath: "images/agents/varied-plants/buttons/seedpack_z.png",
            traits: [
              new Trait({
                name: "size",
                "default": 5
              }), new Trait({
                name: "root size",
                "default": 1
              })
            ],
            limit: 15
          }
        ],
        toolButtons: [
          {
            type: ToolButton.INFO_TOOL
          }
        ]
      });
      document.getElementById('environment').appendChild(this.interactive.getEnvironmentPane());
      this.env = env;
      this.plantSpecies = plantSpecies;
      startingMoney = 20;
      moneyLeft = 20;
      updateMoney = function(val) {
        moneyLeft = val;
        return document.getElementById('money-value').innerHTML = "$" + val;
      };
      Events.addEventListener(Environment.EVENTS.RESET, function() {
        return updateMoney(startingMoney);
      });
      return Events.addEventListener(Environment.EVENTS.AGENT_ADDED, function(evt) {
        if (!evt.detail.agent.bred) {
          return updateMoney(moneyLeft - 1);
        }
      });
    },
    preload: ["images/agents/varied-plants/buttons/seedpack_z.png"]
  };

  window.onload = function() {
    return helpers.preload([model, env, plantSpecies], function() {
      return model.run();
    });
  };

}).call(this);
