// Generated by CoffeeScript 1.7.1
(function() {
  var Environment, Rule, col, env, row, water, _i, _j, _ref, _ref1;

  Environment = require('models/environment');

  Rule = require('models/rule');

  env = new Environment({
    columns: 52,
    rows: 58,
    imgPath: "images/environments/water5levels.png",
    barriers: [[0, 0, 520, 35], [0, 465, 520, 115], [0, 35, 18, 430], [100, 35, 18, 430], [200, 35, 18, 430], [300, 35, 18, 430], [400, 35, 18, 430], [500, 35, 20, 430]],
    wrapEastWest: true,
    wrapNorthSouth: true
  });

  for (col = _i = 0, _ref = env.columns; 0 <= _ref ? _i <= _ref : _i >= _ref; col = 0 <= _ref ? ++_i : --_i) {
    for (row = _j = 0, _ref1 = env.rows; 0 <= _ref1 ? _j <= _ref1 : _j >= _ref1; row = 0 <= _ref1 ? ++_j : --_j) {
      water = (function() {
        switch (false) {
          case !(col < 13):
            return 0.1;
          case !(col < 22):
            return 0.25;
          case !(col < 32):
            return 0.5;
          case !(col < 41):
            return 0.75;
          default:
            return 1;
        }
      })();
      env.set(col, row, "water", water);
    }
  }

  env.addRule(new Rule({
    test: function(agent) {
      return agent.get('age') > (agent.species.defs.SPROUT_AGE + 4);
    },
    action: function(agent) {
      var diff, health, size;
      size = agent.get('root size');
      water = agent.get('water');
      diff = Math.abs(size - (water * 10));
      health = 1 - (diff / 20);
      return agent.set('health', health);
    }
  }));

  env.addRule(new Rule({
    action: function(agent) {
      var immortal;
      immortal = agent.get('age') < (agent.species.defs.SPROUT_AGE + 10) || agent.get('health') >= 0.87;
      return agent.set('is immortal', immortal);
    }
  }));

  env.addRule(new Rule({
    action: function(agent) {
      var flowers;
      flowers = agent.get('age') > agent.species.defs.MATURITY_AGE && agent.get('health') >= 0.95;
      return agent.set('has flowers', flowers);
    }
  }));

  require.register("environments/water-flowerboxes", function(exports, require, module) {
    return module.exports = env;
  });

}).call(this);
